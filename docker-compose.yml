version: '3.8'

services:

  ms-registry-server:
    build: ./registry-server
    container_name: ms-registry-server
    ports:
      - "8761:8761"

  ms-config-server:
    build: ./config-server
    container_name: ms-config-server
    depends_on:
      - ms-registry-server
    environment:
      EUREKA_URL: http://ms-registry-server:8761/eureka/
    ports:
      - "8888:8888"

  ms-admin-core:
    build: ./admin-core-service
    container_name: ms-admin-core
    depends_on:
      - ms-config-server
      - ms-registry-server
    environment:
      CONFIG_SERVER_HOST: http://ms-config-server:8888
      EUREKA_URL: http://ms-registry-server:8761/eureka/
      SPRING_DATASOURCE_URL: jdbc:postgresql://dpg-d1sqnler433s73ekut4g-a.oregon-postgres.render.com:5432/credi
      SPRING_DATASOURCE_USERNAME: crediahorro
      SPRING_DATASOURCE_PASSWORD: kKzXfS67Wfivr0dQ3nnJDWa9qhsl60Ag

  ms-report:
    build: ./report-ms
    container_name: ms-report
    depends_on:
      - ms-config-server
      - ms-registry-server
    environment:
      CONFIG_SERVER_HOST: http://ms-config-server:8888
      EUREKA_URL: http://ms-registry-server:8761/eureka/

  ms-report-grafico:
    build: ./report-grafico
    container_name: ms-report-grafico
    depends_on:
      - ms-config-server
      - ms-registry-server
    environment:
      CONFIG_SERVER_HOST: http://ms-config-server:8888
      EUREKA_URL: http://ms-registry-server:8761/eureka/

  ms-auth-service:
    build: ./auth-service
    container_name: ms-auth-service
    depends_on:
      - ms-config-server
      - ms-registry-server
    environment:
      CONFIG_SERVER_HOST: http://ms-config-server:8888 
      EUREKA_URL: http://ms-registry-server:8761/eureka/
      SPRING_DATASOURCE_URL: jdbc:postgresql://dpg-d1sqnler433s73ekut4g-a.oregon-postgres.render.com:5432/credi
      SPRING_DATASOURCE_USERNAME: crediahorro
      SPRING_DATASOURCE_PASSWORD: kKzXfS67Wfivr0dQ3nnJDWa9qhsl60Ag
    ports:
      - "3030:3030"

  ms-notificacion-service:
    build: ./notificacion-service
    container_name: notificacion-service
    depends_on:
      - ms-registry-server
    environment:
      EUREKA_URL: http://ms-registry-server:8761/eureka/
    ports:
      - "5555:5555"

  ms-gateway:
    build: ./gateway
    container_name: ms-gateway
    depends_on:
      - ms-registry-server
    environment:
      EUREKA_URL: http://ms-registry-server:8761/eureka/
    ports:
      - "4040:4040"

  ms-frontend:
    build: ./frontend/crediahorro
    container_name: ms-frontend
    depends_on:
      - ms-gateway
    ports:
      - "4200:80"
